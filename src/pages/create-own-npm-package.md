---
title: "Что такое пакетный менеджер npm. Соберем, задеплоим и протестируем свой пакет"
date: "2021-02-01"
tags: ["Javascript", "Frontend"]
active: "true"
---

Когда вы разрабатываете большие приложения, в один момент вы сталкиваетесь с необходимостью переиспользования готовых решений,
с целью ускорения разработки и уменьшения количества велосипедов для решения одной проблемы 

## Что такое npm и зачем он нужен?

> **NPM** - это самый крупный менеджер пакетов,
> который позволяет разработчикам со всего света делиться готовыми решениями для различных задач,
> а также использовать готовые наработки

Пакетный менеджер также можно использовать как приватное хранилище библиотек, некоторые компании так делают, но сегодня мы поговорим именно о публичном использовании.

[На официальном сайте](https://docs.npmjs.com/about-npm) можно подробнее ознакомиться с описанием.

В этой статье мы не будем уделять много времени сравнению менеджеров пакетов и детально погружаться в их работу.

Сосредоточимся на создании своей библиотеки и поделимся ей с другими.

## Установка npm

Для начала необходимо установить себе на компьютер актуальную версию ```node.js``` и ```npm CLI```.

> **CLI** - command line interface (Интерфейс, который предоставляет набор команд для работы библотекой. В данном случае с npm)

Скачать Node.js можно с [официального сайта](https://nodejs.org/en/download/).
Вместе с ним установится CLI для работы с npm.

Проверьте, что установка прошла корректно, введя в командной строке Windows или терминале Mac OS

```shell script
node -v
npm -v
```

## Создаем папку с проектом
Для примера мы создадим простой модуль, который предоставляет функции для работы с математическими операциями.
Конечно, такой модуль наверняка уже есть, но мы делаем это для примера. Вы сможете придумать свое уникальное решение
и поедлиться им с другими.

Создаем папку для вашего проекта библиотеки.
```shell script
mkdir math-package
```

Теперь нам необходимо сделать из нашего проекта библиотеку и сгенерировать специальный файл с мета информацией для npm

Для этого переходим в папку с проектом
```shell script
cd math-package
```

И инициализируем npm
```shell script
npm init
```

Далее npm задаст нам пару вопросов, чтобы уточнить некоторую информацию о проекте (Название, версия и тд). Можно нажать на все Enter.

В корне проекта у вас появится файл ```package.json```, который содержит информацию о вашем проекте.

```json
{
  "name": "simple-math-package",
  "version": "1.0.1",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC"
}
```

Обратите внимание, что я изменил название библиотеки в поле ```name```. Вам следует тоже это сделать, так как в npm не может быть несколько библиотек с идентичным названием.

## Напишем код нашей библиотеки

В файле ```package.json```, поле ```main``` указывает на корневой файл модуля. Создадим его в проекте.
```shell script
touch index.js
```

Напишем простую функцию, которая принимает на вход два числа и выводит их сумму. И экспортируем ее.
```javascript
function sum(a, b) {
    return a + b;
}

module.exports = {
    sum: sum
}

```

## Публикуем модуль в npm
Можно сказать, что наш модуль уже готов к публикации.

Перед тем как опубликовать его, нам необходимо залогиниться в npm из командной строки. Перед этим нужно зарегистрироваться на официальном сайте.
Далее вводим:
```shell script
npm login
```
Вводим реквезиты и публикуем наш модуль.
```shell script
npm publish --access=public
```

Ура! Теперь вы можете зайти на [официальный сайт](https://www.npmjs.com/) и в поиске найти вашу библиотеку по названию из ```package.json```

## Протестируем наш модуль

Для этого достаточно создать новый проект и проделать следующие действия:
- Инициализировать npm
- Создать файл, например app.js
- Установить нашу библиотеку
- Импортировать функцию sum из библиотеки и использовать ее
- Запустить файл и проверить результат

```shell script
mkdir test-math-package
cd test-math-package
npm init
touch app.js
npm install simple-math-package
```

```js
// in your app.js file
const { sum } = require('simple-math-package');

console.log(sum(1,2));
```

```shell script
node app.js
```

По итогу в командной строке у вас должен вывестись результат 3

## Что за папка node_modules?
> **node_modules** хранит все установленные пакеты в вашем проекте, а также пакеты ваших пакетов.

## Что дальше?

Если вы захотите обновить библиотеку, добавив новых функций, то перед публикацией в файле ```package.json``` необходимо
повысить версию вашего модуля в поле ```version```, например с 1.0.0 до 1.0.1

Так как npm не даст опубликовать проект с одной версией дважды.

О версионировании мы также поговорим в следующих статьях!
