---
title: "Как проводить Code Review?"
date: "2021-04-15"
tags: ["Советы"]
active: "true"
---

## Что такое Code Review?

Code Review может проводиться в нескольких контекстах. Первый это проверка кода стажера/джуна,
когда необходимо дать обратную связь по его работе. Второе - проверка Merge Request, который в последствии
будет влит в общую ветку.

Те пункты, о которых я расскажу можно отнести к обоим случаям. Но больше всего я буду уделять внимание
проверке Merge Request. Это основная часть работы программистов.

При проверке кода на вас также лежит ответственность за то, какой код попадет в общую ветку.
И ваша задача исследовать его в доль и поперек.

>**Правило 1. Относись ответственно к проведению Code Review.**

## Критика и конфликты

Разработчик, который отправляет код на ревью, скорее всего очень уверен в своем решении. И ожидает, что
его МР будет влит без комментариев.

>**Правило 2. Будь готов к критике и желай ее.**

В первую очередь цель коллективной проверки кода привнести максимально оптимальное решение.
А также получить несколько мнений касательно возможных решений проблемы.
Это возможность научиться новому и докопаться до истины через дискуссию.

Если объемный Merge Request влит без комментариев, вы либо машина, либо всем все равно.

>**Правило 3. Критикуй конструктивно и не опускайся до личностей.**

Соблюдайте корректность в написании комментариев к коду. И не позволяйте автору почувствовать
негативный тон в свою сторону. Например:
**"По-моему это глупое решение, помещать данную функцию в этот модуль"**, **"Ты забыл удалить неиспользуемый код"**

Старайтесь обосновывать свое мнение аргументами. Пояснить, почему ваше решение оптимальнее написанного.
Возможно даже прикрепить ссылки на материалы, которые помогут обосновать ваш ответ.

## Что проверять?

Запомни важное правило, проверяй то, что может заметить или исправить только человек.
Поэтому старайся всю рутину отдавать инструментам автоматического анализа кода (линтеры).
Что входит в рутину?
- Проверка соответствию корпоративному стилю кода. (отступы, пробелы, форматирование, наименования)
- Неиспользуемые переменные или модули

>**Правило 4. Рутину отдавай на проверку анализаторам кода.**

Но в то же время необходимо проверять целесообразность наименований классов, методов и переменных
с точки зрения смысла и понимания содержания.

**Так что проверять-то?**

Для того, чтобы понять, что проверять, важно при проверке научиться отвечать на следующие вопросы:

>**Правило 5. Нужен ли этот код здесь?**

Для этого перед проверкой необходимо быть в контексте задачи, в рамках которой был сделан Merge Request.
Желательно, чтобы ревью проводили те, кто уже хорошо знаком с проектом или задачами. Это ускорит процесс,
а ревью будет более качественным.

Измененный код должен четко относиться к задаче. Не должно быть лишних изменений типа
"О наведу-ка я порядок тут в рамках своей задачи". В дальнейшем будет затруднительно отыскать проблему и откатить изменения. 

>**Правило 6. Можно ли это как-то улучшить оптимизировать или упростить?**

Возможно метод или класс, находиться не в том модуле/пакете, и с точки зрения смысла и контекста его стоило бы
поместить в другое место. Или у метода слишком много ответственности, и его следует разбить на несколько небольших.

Насколько пригоден код для переиспользования в других частях системы. Возможно стоит над этим подумать.

Возможно есть наиболее оптимальная библиотека во внешнем репозитории или в репозитории внутри вашей компании.

Также решение может быть слишком усложнено. Неуместное и чрезмерное использование шаблонов проектирования.
Сложная логика условий и циклов.

>**Правило 7. На что могут повлиять изменения?**

Это очень важная часть. Разработчик мог не уследить за тем, что его изменения повлекли за собой нарушения
в других частях системы. Для этого должны быть написаны тесты и прогоняться перед коммитом.

Могла быть нарушена безопасность. Некорректная авторизация, недостающая информация в логах.

>**Правило 8. Понятен ли мне код без пояснения? Будет ли он понятен новым разработчикам?**

Удобочитаемость кода касается каждого и даже лично вас. Возможно через время всем будет затруднительно понять,
что происходит в данной части системы. В свою очередь это усложнит внесение изменений.

## Как проверять?

>**Правило 9. Не нужно заигрываться**

Можно бесконечно оптимизировать код и находить наилучшие решения. Но необходимо помнить о времени
выполнения задач и целесообразности чрезмерной оптимизации.

В решении могут быть проблемные места, которые не так критичны на данный момент.
В таком случае можно попросить автора оставить в коде комментарий с пометкой TODO,
для рефакторинга позднее.

```javascript
// TODO: разбить решение на более мелкие функции
```

>**Правило 10. Пробегитесь по изменениям и оцените масштабы**

Начните с более высокого уровня. Проверяйте сначала реализацию с архитектурной точки зрения.
А затем спускайтесь ниже до наименований переменных и комментариев в коде.

Для этого весь процесс ревью кода можно сделать в несколько итераций.

В сложных ситуациях можно собраться с разработчиком или несколькими коллегами для обсуждения спорных моментов.
