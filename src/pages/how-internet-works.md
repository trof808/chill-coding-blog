---
title: "Как работает интернет"
date: "2021-01-31"
tags: ["Web"]
active: "true"
---

Прежде чем вы приступите к изучению веб разработки, я бы хотел, чтобы вы были знакомы с тем, что происходит за кулисами работы интернета

Понимание того, какой маршрут необходимо совершить браузеру, прежде чем отрисовать страницу, позволит вам писать более оптимизированный код для ваших будущих приложений

Есть два участника Клиенты и серверы

По сути клиенты, как правило, это наши компьютеры, которые подключены к сети интрнет, и с которых мы потребляем информацию. 
Серверы это тоже компьютеры, но они предназначены для хранения информации, например сайты. Это означает, что из вашего компьютера тоже можно сделать сервер.

## Что происходит после ввода url в браузере?
### Определение DNS

Браузеру в первую очередь необходимо найти адрес сервера, на котором расположен сайт

Если вы ранее вводили его, то браузер мог закэшировать результат, поэтому он сначала ищет его у себя в кэше.
Если домена нет в кэше, то браузер обращается к локальному файлу ```hosts``` [Подробнее о нем](https://ru.wikipedia.org/wiki/Hosts)

Адрес не был найден ни в кэше, ни в файле hosts. Тогда браузер разбивает url на куски и обращается к DNS-серверу, обычно это DNS сервер провайдера

> **DNS** - Это распределенная база данных, которая хранит информацию о доменах. Чаще всего используется для поиска IP-адреса сервера
[Википедя](https://ru.wikipedia.org/wiki/DNS)

После этого браузер получает адрес сервера примерно в таком видео 172.217.8.174. Это адрес серверов гугл, который мно получить пинганув домен из командной строки
```javascript
ping `google.com`
```

Адрес локально сервера обычно выглядит следующим образом 127.0.0.1 или другим словом localhost.

## Отправляем запрос серверу
Получив адрес сервера, браузер отправляет запрос к нему для получения информации, например загрузки сайта и последующего его отображения
Из URL браузер получает информацию о доступном открытом порте (80 - HTTP, 433 HTTPS) и открывает сокет соединение

### Протоколы передачи данных
> **Протокол передачи данных** - определяет правила по которым клиент передает информацию на сервер и получает ее обратно.
> Все равно что если бы вы отправляли письмо и указывали адрес получателя, имя, отправителя и всю необходимую информацию,
> чтобы успешно доставить письмо и получить ответ

Передача данных проходит через несколько уровней протоколов.

### TCP/IP
Самый низкий уровень и самый главный - транспортный. Сюда относится протокол TCP/IP.
Он определяет каким образом данные передаются по сети. С примером отправки письма, это как средства передачи.
Можно отправить поездом, самолетом или голубем.
 
### Прикладные уровни (HTTP, FTP, SSH)
Наиболее интересны для нас протоколы уровня приложений.
Эти протоколы отвечают за то как между собой общаются клиенты и серверы. Они являются протоколами высокого уровня и вам с ними придется работать больше всего.

Рассмотрим один из них.

> Протокол HTTP - предназначен для передачи Web-страниц между клиентом и сервером.

Пример как выглядит описание запроса к серверу
```javascript
`GET / HTTP/2.0
Host: google.com
Cookie: io=-awyzJB2RDwauMDbAAAk
Accept: text/html,application/xhtml+xml`
```

Это именно то, что мы отправляем серверу из приложения REST запросами.
Информация, которую мы сообщаем серверу в протоколе HTTP:

- Метод запроса GET, POST, DELETE, UPDATE, PUT
- Адрес хоста по которому расположен сервер
- Различные заголовки, например формат данных (картинка, json, text и др)
- Различные токены, например авторизация
- Данные из Cookie
- Способы сжатия данных
- Правила кэширования ответа
- И еще много всего...

Метод запроса является важной составляющей. Сервер может уметь обрабатывать запрос по конкретному URL,
но ограничить его методами, которые он может принимать. Например только GET или POST

[Подробнее о методах запросов HTTP](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods)

### Получаем ответ от сервера
Проток HTTP предусматривает статусы, так называемые коды ответов, которые нам присылает сервер в случае успешного или неудачного запроса.

Например, если запрос прошел успешно, то сервер присылает нам ответ со статусом 200. Также запрос мог быть с ошибкой, если мы отправили
его на несуществующий адрес сервера. Тогда сервер вернет ответ со статусов 404 (URL not found)

Со всеми кодами ошибок HTTP можно [ознакомиться тут](https://ru.wikipedia.org/wiki/Список_кодов_состояния_HTTP)

Также в ответе сервер мог включить дополнительные заголовки, например самостоятельно устанавливать cookie в браузере клиента
```javascript
`Set-Cookie: <cookie-name>=<cookie-value>`
```

В случае успешного ответа, сервер отправляет данные клиенту по кусочкам, маленькими порциями, которые обязательно должны быть доставлены. 

### Что дальше?

После того, как браузер окончательно получил данные, начинается отрисовка сайта

Это отдельный огромный процесс, который я опишу в следующей статье
